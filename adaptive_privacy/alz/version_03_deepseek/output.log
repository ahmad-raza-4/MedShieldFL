nohup: ignoring input
/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py:95: UserWarning: Secure RNG turned off. This is perfectly fine for experimentation as it allows for much faster training performance, but remember to turn it on and retrain one last time before production with ``secure_mode`` turned on.
  warnings.warn(
01/26/2025 14:45:37:DEBUG:Opened insecure gRPC connection (no certificates were passed)
01/26/2025 14:45:37:DEBUG:ChannelConnectivity.IDLE
01/26/2025 14:45:37:DEBUG:ChannelConnectivity.CONNECTING
01/26/2025 14:45:37:DEBUG:ChannelConnectivity.READY
[92mINFO [0m:      
01/26/2025 14:45:37:INFO:
[92mINFO [0m:      [RUN 0, ROUND ]
01/26/2025 14:45:37:INFO:[RUN 0, ROUND ]
[92mINFO [0m:      Received: get_parameters message 1405a3dc-f5c7-4959-9e6f-71dea3b1e947
01/26/2025 14:45:37:INFO:Received: get_parameters message 1405a3dc-f5c7-4959-9e6f-71dea3b1e947
[92mINFO [0m:      Sent reply
01/26/2025 14:45:42:INFO:Sent reply
[92mINFO [0m:      
01/26/2025 14:45:50:INFO:
[92mINFO [0m:      [RUN 0, ROUND ]
01/26/2025 14:45:50:INFO:[RUN 0, ROUND ]
[92mINFO [0m:      Received: train message 0c65a3a3-1f54-4979-9bb2-46fff3b4bf57
01/26/2025 14:45:50:INFO:Received: train message 0c65a3a3-1f54-4979-9bb2-46fff3b4bf57
/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/accountants/analysis/rdp.py:332: UserWarning: Optimal order is the largest alpha. Please consider expanding the range of alphas to get a tighter privacy bound.
  warnings.warn(
[91mERROR [0m:     Client raised an exception.
Traceback (most recent call last):
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/app.py", line 496, in _start_client_internal
    reply_message = client_app(message=message, context=context)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "client_1.py", line 186, in fit
    self._configure_privacy_engine(noise_multiplier)
  File "client_1.py", line 226, in _configure_privacy_engine
    self.model, self.optimizer, self.trainloader = self.privacy_engine.make_private(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 352, in make_private
    module = self._prepare_model(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 177, in _prepare_model
    self.validate(module=module, optimizer=None, data_loader=None)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 242, in validate
    ModuleValidator.validate(module, strict=True)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/validators/module_validator.py", line 69, in validate
    raise UnsupportedModuleError(errors)
opacus.validators.errors.UnsupportedModuleError: [ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!')]
01/26/2025 14:48:08:ERROR:Client raised an exception.
Traceback (most recent call last):
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/app.py", line 496, in _start_client_internal
    reply_message = client_app(message=message, context=context)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "client_1.py", line 186, in fit
    self._configure_privacy_engine(noise_multiplier)
  File "client_1.py", line 226, in _configure_privacy_engine
    self.model, self.optimizer, self.trainloader = self.privacy_engine.make_private(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 352, in make_private
    module = self._prepare_model(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 177, in _prepare_model
    self.validate(module=module, optimizer=None, data_loader=None)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 242, in validate
    ModuleValidator.validate(module, strict=True)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/validators/module_validator.py", line 69, in validate
    raise UnsupportedModuleError(errors)
opacus.validators.errors.UnsupportedModuleError: [ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!')]
01/26/2025 14:48:08:DEBUG:gRPC channel closed
01/26/2025 14:48:08:ERROR:Client execution failed: [ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!')]
Traceback (most recent call last):
  File "client_1.py", line 325, in <module>
    fl.client.start_client(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/app.py", line 291, in start_client
    _start_client_internal(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/app.py", line 503, in _start_client_internal
    raise ex
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/app.py", line 496, in _start_client_internal
    reply_message = client_app(message=message, context=context)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "client_1.py", line 186, in fit
    self._configure_privacy_engine(noise_multiplier)
  File "client_1.py", line 226, in _configure_privacy_engine
    self.model, self.optimizer, self.trainloader = self.privacy_engine.make_private(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 352, in make_private
    module = self._prepare_model(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 177, in _prepare_model
    self.validate(module=module, optimizer=None, data_loader=None)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 242, in validate
    ModuleValidator.validate(module, strict=True)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/validators/module_validator.py", line 69, in validate
    raise UnsupportedModuleError(errors)
opacus.validators.errors.UnsupportedModuleError: [ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!')]
Traceback (most recent call last):
  File "client_1.py", line 325, in <module>
    fl.client.start_client(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/app.py", line 291, in start_client
    _start_client_internal(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/app.py", line 503, in _start_client_internal
    raise ex
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/app.py", line 496, in _start_client_internal
    reply_message = client_app(message=message, context=context)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "client_1.py", line 186, in fit
    self._configure_privacy_engine(noise_multiplier)
  File "client_1.py", line 226, in _configure_privacy_engine
    self.model, self.optimizer, self.trainloader = self.privacy_engine.make_private(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 352, in make_private
    module = self._prepare_model(
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 177, in _prepare_model
    self.validate(module=module, optimizer=None, data_loader=None)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/privacy_engine.py", line 242, in validate
    ModuleValidator.validate(module, strict=True)
  File "/home/dgxuser16/.local/lib/python3.8/site-packages/opacus/validators/module_validator.py", line 69, in validate
    raise UnsupportedModuleError(errors)
opacus.validators.errors.UnsupportedModuleError: [ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!'), ShouldReplaceModuleError('We do not support nn.MultiheadAttention because its implementation uses special modules. We have written a DPMultiheadAttention class that is a drop-in replacement which is compatible with our Grad Sample hooks. Please run the recommended replacement!')]
